# **Заметки для себя**

## ***Redux-saga строится во круг эффектов.***

**Эффекты** - это функции, которые возвращают простые Javascript-объекты,
которые в свою очередь очередь содержат инструкции для выполнения наших
saga-middleware.
Все эффекты импортируются из redux-saga/effects.

## ***Эффекты делятся на два типа: блокирующие и неблокирующие.***

К **блокирующим** отновится ```take```, который дожидается диспатча экшена в приложении
или эффект ```call``` который выполняет вызов асинхронной функции.

К **неблокирующим** эффектам относятся эффекты ```put, fork, cancel, select```...

**```fork```** - основной эффект для управления параллелизмом между сагами.

___

Результат 
```
const task = yeild fork(fn,args)
``` 
является не результатом функции ```fn```, а **объектом**, который возвращается объект с полезными методами и свойствами, который создает сама Saga.

Также можно дождаться выполнения этой таски используя ```join```.

## ***Небольшие определения***

```call``` - (блокирующий, как await) выполняет переданную функцию. Если функция вернет promise,приостанавливает сагу до тех пор пока promise не вызовет resolve.  
```put``` - диспатчит переданный action.
```takeEvery``` - создает и запускает worker сагу на каждый диспатч данного action
 (неблокирующий) - эффект, который указывает middleware выполнить неблокирующий вызов функции. Управляет параллелизмом между сагами. Если в одном форке будет ошибка, то остальные отменяются  
```spawn``` - создает паралельную задачу в корне саги, сам процесс не привязан к родителю. Не отменяются при ошибке.  
```join``` - заблокировать неблокирующую задачу и получить её результат.  
```select``` - позволяет получить данные из стора. Аналог useSelect/mapStateToProps. Неблокирующий эффект.  
```all``` - запускает несколько эффектов параллельно и ждет их завершения. Если один из эффектов блокирующий,то ```all``` будет блокируюищим.  

**```take``` + ```fork``` - один из основных паттернов**  


При организации кода redux-saga пользуются: watcher/worker.  
***watcher*** - отслеживает действие  в нашем приложении и вызывают worker.  
***worker*** - содержит бизнес-логику по выполенния наших задач.

Нужно указывать типо получаемых данных явно:
src: https://vhudyma-blog.eu/yield-expression-implicitly-results-in-an-any-type-because-its-containing-generator-lacks-a-return-type-annotation/  
 ```
 const todos: AxiosResponse<ITodo[]> = yield call(getTodos);
 ```

### **Типизация функции генератора**:
```
function* func(): Generator<
//step types
CallEffect<Response>,
// return type
void,
// intermediate argument
Response> {
	...
}
```
----

Для **```отслеживания роутеров```**, используется React-Router, React-Router-Dom, redux-first-history(для 6 версии RRD).
___


## ***Аборт fetch запроса при медленном соединении***

*пример в папке ```clickSagaAbort/index.ts```.

**AbortController** - позволяет отменять fecth запросы.  
src: https://learn.javascript.ru/fetch-abort


